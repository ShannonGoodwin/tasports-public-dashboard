<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TasPorts – Water Quality Dashboard</title>

  <link rel="stylesheet" href="/styles.css" />
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
</head>

<body>
  <header class="header" id="top">
    <div class="header__inner">
      <div class="brand">
        <img src="/logo.png" alt="TasPorts" class="brand__logo" />
        <div>
          <h1 class="brand__title">TasPorts Dredging Program – Water Quality Dashboard</h1>
          <p class="brand__sub">
            Public reporting interface. Data are displayed as received from telemetry systems and may be unvalidated.
          </p>
        </div>
      </div>

      <nav class="header__nav">
        <a class="navpill navpill--active" href="/index.html">Map + live tiles</a>
        <a class="navpill" href="/charts.html">Live charts</a>
        <a class="navpill" href="/calibration.html">Instrument calibration</a>
      </nav>
    </div>
    <div class="header__divider"></div>
  </header>

  <main class="layout">

    <!-- =========================
         TURBIDITY TILES
    ========================== -->
    <section class="panel">
      <div class="panel-head">
        <div>
          <h2>Turbidity (rolling medians)</h2>
          <!-- NEW: populated by app.js -->
          <div id="dataRefreshed" class="small subtle"></div>
        </div>

        <div class="status-legend" aria-label="Turbidity status legend">
          <div class="status-legend__title">Turbidity status</div>
          <div class="status-legend__items">
            <span class="status-legend__item"><span class="swatch swatch--neutral"></span> No trigger (informational)</span>
            <span class="status-legend__item"><span class="swatch swatch--green"></span> Below trigger</span>
            <span class="status-legend__item"><span class="swatch swatch--amber"></span> Investigation required</span>
            <span class="status-legend__item"><span class="swatch swatch--red"></span> Trigger exceeded</span>
            <span class="status-legend__item"><span class="swatch swatch--stale"></span> Stale (&gt;24h)</span>
            <span class="status-legend__item"><span class="swatch swatch--error"></span> Error / missing</span>
          </div>
        </div>
      </div>

      <!-- Unit note -->
      <p class="note">
        Turbidity is shown in <strong>FNU</strong> (telemetry).
        Trigger values as defined in the Adaptive Monitoring and Management Plan (AMMP) are defined in <strong>NTU</strong>;
        FNU and NTU are considered comparable for environmental monitoring.
      </p>

      
      <div class="tiles-split">
        <div class="tiles-panel">
          <div class="tiles-panel__title">6-day rolling median</div>
          <div id="turbidity-tiles-6d" class="tiles-grid"></div>
        </div>

        <div class="tiles-panel">
          <div class="tiles-panel__title">15-day rolling median</div>
          <div id="turbidity-tiles-15d" class="tiles-grid"></div>
        </div>
      </div>
    </section>

    <!-- =========================
         MAP
    ========================== -->
    <section class="panel panel--map">
      <h2>Site map</h2>
      <div id="map"></div>
    </section>

  </main>

  <footer class="footer">
    <div class="footer__inner">
      <div class="small subtle">
        Data source: Eagle.io (Xylem telemetry platform).
        Tiles are derived from anonymous public data links; charts are anonymous public embeds.
        &nbsp;•&nbsp;
        <a class="footer__link" href="/calibration.html">Instrument calibration</a>
      </div>
    </div>
  </footer>

  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>
  <script src="/app.js"></script>
</body>
</html>

